<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.appsys.dao.AppInfoMapper">
	<select id="getAppInfoTotalCount" resultType="int"
		parameterType="AppInfo">
		SELECT COUNT(1)
		FROM
		<where>
			<if test="softwareName!=null and softwareName!=''">
				and softwareName like concat('%',#{softwareName},'%')
			</if>
			<if test="STATUS!=0">
				and STATUS = #{STATUS}
			</if>
			<if test="flatformId!=0">
				and flatformId = #{flatformId}
			</if>
			<if test="categoryLevel1!=0">
				and categoryLevel1 = #{categoryLevel1}
			</if>
			<if test="categoryLevel2!=0">
				and categoryLevel2 = #{categoryLevel2}
			</if>
			<if test="categoryLevel3!=0">
				and categoryLevel3 = #{categoryLevel3}
			</if>
		</where>
	</select>
	<select id="getAppInfosByPage" resultType="AppInfo">
		SELECT
		appinfodb.app_info.id AS id,
		softwareName,
		APKName,
		softwareSize,
		appinfodb.data_dictionary.valueName2 AS flatformName,
		appinfodb.data_dictionary1.valueName1 AS statusName,
		downloads,
		appinfodb.app_category.categoryName1 AS categoryLevel1Name,
		appinfodb.app_category1.categoryName2 AS categoryLevel2Name,
		appinfodb.app_category2.categoryName3 AS categoryLevel3Name,
		versionId AS versionNo
		FROM
		appinfodb.app_info INNER JOIN
		appinfodb.data_dictionary ON
		appinfodb.data_dictionary.valueId2 = flatformId
		INNER JOIN appinfodb.data_dictionary1 ON
		appinfodb.data_dictionary1.valueId1 = STATUS
		INNER JOIN
		appinfodb.app_category ON categoryLevel1 =
		appinfodb.app_category.categoryId1
		INNER JOIN appinfodb.app_category1 ON categoryLevel2 =
		appinfodb.app_category1.categoryId2
		INNER JOIN appinfodb.app_category2
		ON categoryLevel3 = appinfodb.app_category2.categoryId3
		GROUP BY
		softwareName

	</select>
</mapper>